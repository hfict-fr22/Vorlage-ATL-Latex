% !TEX root = main.tex

%----------------------------
%   SCHRIFTARTEN UND 
%----------------------------

% Support for special characters
%\usepackage[utf8]{inputenc}    % Specify input encoding
%\usepackage[T1]{fontenc}       % Specify font encoding

% Set main fonts
% Fonts catalogue: https://tug.org/FontCatalogue/
% Wichtig: für Arial ist LuaLaTex notwendig!

\usepackage{fontspec}
\setmainfont{Arial}

%Font für Listing
\newfontfamily{\lstsansserif}[Scale=1.0]{Arial}

%----------------------------
%   Environments
%----------------------------

\usepackage{caption}           % Customized caption
\usepackage{subcaption}        % Subfigure captions
\usepackage{makecell}          % Per-cell formatting in tables (\makecell)
\usepackage{pdfpages}          % Required to include PDF files/graphics (\includepdf)

\usepackage{todonotes}         % Introduces the command \todo
\setlength{\marginparwidth}{2.5cm} % Adjust this if the todo notes are out of margins

% Create boxes as follows:
% \begin{colorbox}{red}{2}
\usepackage{tcolorbox}
\newtcolorbox{textbox}[2]{
    arc=3pt,
    boxrule=#2pt,
    colback=#1!25!white,
    width=\textwidth,
    halign=left,
    valign=center,
    colframe=#1!75!black
}

%----------------------------
%   Colors
%----------------------------

% Set up colors
\usepackage{xcolor}
\usepackage{colortbl}
% ZHAW Blue: Pantone 2945 U / R0 G100 B166
\definecolor{zhawblue}{rgb}{0.00, 0.39, 0.65}
% Colors related to code listings
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{codebackground}{rgb}{0.93,0.94,0.95}

%----------------------------
%   Code listings
%----------------------------

% Setup code listings
\usepackage{listings}
\lstdefinestyle{mystyle}{
    backgroundcolor=\color{codebackground},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\lstsansserif,
    breakatwhitespace=false,
    breaklines=true,
    captionpos=b,
    keepspaces=true,
    numbers=left,
    numbersep=5pt,
    showspaces=false,
    showstringspaces=false,
    showtabs=false,
    tabsize=4
}
\lstset{style=mystyle}

% minted is an alternative code listing package. (See chapter 2)
% For it to run successfully, ensure the following:
% - the Python package Pygments. Install with the following command:
%       python -m pip install Pygments
% - pdflatex (or xelatex) is executed with the flag --shell-escape
%   If you are using a TEX editor, you can modify the typesetting 
%   command somewhere in the settings.
%\usepackage[outputdir=build]{minted}
%\usemintedstyle{xcode}
% For fancier coloring schemes, see here:
% https://tex.stackexchange.com/questions/585582
% One could also create an own style in Pygments
% https://pygments.org/docs/styles/#creating-own-styles

%----------------------------
%   References
%----------------------------

% Set up references
\usepackage[
    backend=biber,             % Use biber backend (an external tool)
    sorting=nyt,              % Sortierung nach Name, Jahr, Titel
    style=apa                  % Choose here your preferred citation style
]{biblatex}
\DeclareLanguageMapping{ngerman}{ngerman-apa} % Sprache in Deutsch
\addbibresource{quellen.bib}   % The filename of the bibliography

\usepackage[autostyle=true]{csquotes} 
                               % Required to generate language-dependent quotes 
                               % in the bibliography
\DefineBibliographyStrings{ngerman}{%
  retrieved = {Abgerufen},
  from = {von}}

\DeclareFieldFormat{url}{\url{#1}}
\DeclareFieldFormat{abstracturl}{\url{#1}}
\DeclareFieldFormat{urldate}{#1}

\renewbibmacro*{url+urldate}{%
  \ifthenelse{\(\iffieldundef{url}\AND\iffieldundef{abstracturl}\AND\iffieldundef{abstractloc}\)\OR\NOT\iffieldundef{doi}}
  {}
  {\ifthenelse{\iffieldundef{abstracturl}\AND\iffieldundef{abstractloc}}
    {}
    {\printtext{\bibcpstring{abstract}}\addspace}%
    \printtext{\bibstring{retrieved}}%
    \setunit{\addspace}%
    \iffieldundef{urlyear}
    {}
    {\printurldate%
      \setunit*{\addcomma\space}}% hier Komma einfügen
    \printtext{\bibstring{from}}%
    \setunit*{\addspace}%
    \printfield{urldescription}%
    \setunit*{\addcolon\addspace}%
    \iffieldundef{url}{}{\printfield{url}\renewcommand*{\finentrypunct}{\relax}}%
    \iffieldundef{abstractloc}{}{\printfield{abstractloc}\renewcommand*{\finentrypunct}{\relax}}
    \iffieldundef{abstracturl}{}{\printfield{abstracturl}\renewcommand*{\finentrypunct}{\relax}}}}

%----------------------------------------------------------------------------------------
%   MARGIN SETTINGS
%----------------------------------------------------------------------------------------

\geometry{
    % Muss gegebenfalls angepasst werden. Die Masse wurden mit einem Ausdruck überprüft.
    paper=a4paper,      % Change to letterpaper for US letter
    inner=2.5cm,        % Rand innen -> Gemäss Definition 3.0cm
    outer=1.5cm,        % Rand aussen -> Gemäss Definition 1.5cm
    top=2.5cm,          % Rand oben -> Gemäss Definition 3.0cm
    bottom=2.0cm,       % Rand untern -> Gemäss Definition 2.5cm
    bindingoffset=0.5cm, % Binding offset
    %showframe,         % Show the type block of the page
}
\setlength{\parskip}{1em}
\usepackage{enumitem}          % Layout control for list environments (e.g, itemize)
%\setlist{noitemsep}           % Suppress extra spaces between items
%\setlist{nosep}               % Suppress spaces before/after list environments

%----------------------------------------------------------------------------------------
%   OTHER SETTINGS
%----------------------------------------------------------------------------------------

\newcommand{\keyword}[1]{\textbf{#1}}
\newcommand{\tabhead}[1]{\textbf{#1}}
\newcommand{\code}[1]{\texttt{#1}}
\newcommand{\file}[1]{\texttt{\bfseries#1}}
\newcommand{\option}[1]{\texttt{\itshape#1}}

%----------------------------------------------------------------------------------------
%   MS WORD FARBEN (ÄHNLICH)
%----------------------------------------------------------------------------------------
\usepackage{colortbl}

%Grün, Akzent 6
\definecolor{MSOGrünAk6}{RGB}{112,173,71}
\definecolor{MSGrünAk6H80}{RGB}{226,239,217}
\definecolor{MSGrünAk6H60}{RGB}{197,224,179}
\definecolor{MSGrünAk6H40}{RGB}{168,208,141}
\definecolor{MSGrünAk6D25}{RGB}{83,129,53}
\definecolor{MSGrünAk6D50}{RGB}{56,86,35}

%Blau, Akzent 5
\definecolor{MSBlauAk5}{RGB}{91,155,213}
\definecolor{MSBlauAk5H80}{RGB}{222,234,246}
\definecolor{MSBlauAk5H60}{RGB}{189,214,238}
\definecolor{MSBlauAk5H40}{RGB}{156,194,229}
\definecolor{MSBlauAk5D25}{RGB}{46,116,181}
\definecolor{MSBlauAk5D50}{RGB}{31,78,121}

%Gold, Akzent 4
\definecolor{MSGoldAk4}{RGB}{255,192,0}
\definecolor{MSGoldAk4H80}{RGB}{255,242,204}
\definecolor{MSGoldAk4H60}{RGB}{255,229,153}
\definecolor{MSGoldAk4H40}{RGB}{255,217,102}
\definecolor{MSGoldAk4D25}{RGB}{191,143,0}
\definecolor{MSGoldAk4D50}{RGB}{128,96,0}

%Grau, Akzent 3
\definecolor{MSGrau3}{RGB}{165,165,165}
\definecolor{MSGrau3H80}{RGB}{237,237,237}
\definecolor{MSGrau3H60}{RGB}{219,219,219}
\definecolor{MSGrau3H40}{RGB}{201,201,201}
\definecolor{MSGrau3D25}{RGB}{123,123,123}
\definecolor{MSGrau3D50}{RGB}{82,82,82}

%Orange, Akzent 2
\definecolor{MSOrange2}{RGB}{237,125,49}
\definecolor{MSOrange2H80}{RGB}{251,228,213}
\definecolor{MSOrange2H60}{RGB}{247,202,172}
\definecolor{MSOrange2H40}{RGB}{244,176,131}
\definecolor{MSOrange2D25}{RGB}{196,89,17}
\definecolor{MSOrange2D50}{RGB}{131,60,11}

%Blau, Akzent 1
\definecolor{MSBlau1}{RGB}{68,114,196}
\definecolor{MSBlau1H80}{RGB}{217,226,243}
\definecolor{MSBlau1H60}{RGB}{180,198,231}
\definecolor{MSBlau1H40}{RGB}{142,170,219}
\definecolor{MSBlau1D25}{RGB}{47,84,150}
\definecolor{MSBlau1D50}{RGB}{31,56,100}

%Blaugrau, Text 2
\definecolor{MSBlauGrau2}{RGB}{68,84,106}
\definecolor{MSBlauGrau2H80}{RGB}{213,220,228}
\definecolor{MSBlauGrau2H60}{RGB}{172,185,202}
\definecolor{MSBlauGrau2H40}{RGB}{132,150,176}
\definecolor{MSBlauGrau2D25}{RGB}{50,62,79}
\definecolor{MSBlauGrau2D50}{RGB}{34,42,53}

%Hellgrau, Hintergrund 2
\definecolor{MSHellGrau2}{RGB}{231,230,230}
\definecolor{MSHellGrau2H80}{RGB}{208,206,206}
\definecolor{MSHellGrau2H60}{RGB}{174,170,170}
\definecolor{MSHellGrau2H40}{RGB}{118,113,113}
\definecolor{MSHellGrau2D25}{RGB}{59,56,56}
\definecolor{MSHellGrau2D50}{RGB}{23,23,23}

%Schwarz, Text 1
\definecolor{MSSchwarz1}{RGB}{0,0,0}
\definecolor{MSSchwarz1H80}{RGB}{127,127,127}
\definecolor{MSSchwarz1H60}{RGB}{89,89,89}
\definecolor{MSSchwarz1H40}{RGB}{64,64,64}
\definecolor{MSSchwarz1D25}{RGB}{38,38,38}
\definecolor{MSSchwarz1D50}{RGB}{13,13,13}

%Weiss, Hintergrund 1
\definecolor{MSWeiss1}{RGB}{255,255,255}
\definecolor{MSWeiss1H80}{RGB}{242,242,242}
\definecolor{MSWeiss1H60}{RGB}{217,217,217}
\definecolor{MSWeiss1H40}{RGB}{191,191,191}
\definecolor{MSWeiss1D25}{RGB}{166,166,166}
\definecolor{MSWeiss1D50}{RGB}{128,128,128}

%Einfarbige
\definecolor{MSLila}{RGB}{112,48,160}
\definecolor{MSDunkelblau}{RGB}{0,32,96}
\definecolor{MSBlau}{RGB}{0,112,192}
\definecolor{MSHellblau}{RGB}{0,176,240}
\definecolor{MSGrün}{RGB}{0,176,80}
\definecolor{MSHellgrün}{RGB}{146,208,80}
\definecolor{MSGelb}{RGB}{255,255,0}
\definecolor{MSOrange}{RGB}{255,192,0}
\definecolor{MSRot}{RGB}{255,0,0}
\definecolor{MSDunkelrot}{RGB}{192,0,0}

%----------------------------------------------------------------------------------------
%   SONSTIGE EINSTELLUNGEN
%----------------------------------------------------------------------------------------
\usepackage{float}
\usepackage{longtable}

%----------------------------------------------------------------------------------------
%   TABELLEN EINSTELLUNGEN
%----------------------------------------------------------------------------------------
\newcolumntype{R}[1]{>{\raggedleft\arraybackslash}p{#1}}        % Einstellung für Rechtsbündig